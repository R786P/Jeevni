<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>जीवनी - आपकी कहानी, आपकी ताकत</title>
    <style>
        :root {
            --primary: #8B5CF6;
            --secondary: #EC4899;
            --light: #F9FAFB;
            --dark: #1F2937;
            --gray: #6B7280;
            --light-gray: #F3F4F6;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.2s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-icon span {
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.75rem;
            font-weight: bold;
            color: var(--dark);
        }

        .logo-subtext {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .nav-desktop {
            display: flex;
            gap: 2rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-item:hover {
            background-color: rgba(139, 92, 246, 0.1);
            color: var(--primary);
        }

        .nav-item.active {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow);
        }

        /* Mobile Navigation */
        .nav-mobile {
            display: none;
            background: white;
            border-top: 1px solid #eee;
        }

        .nav-mobile-items {
            display: flex;
        }

        .nav-mobile-item {
            flex: 1;
            text-align: center;
            padding: 0.75rem 0;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
        }

        .nav-mobile-item.active {
            color: var(--primary);
            font-weight: 500;
        }

        /* Main Content */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Home Tab */
        .hero {
            text-align: center;
            padding: 4rem 0;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .hero-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 2rem;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 1.125rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            border: none;
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(139, 92, 246, 0.1);
            transform: translateY(-2px);
        }

        .featured-stories {
            background: white;
            border-radius: 1rem;
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin: 2rem 0;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 1.5rem;
        }

        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .story-card {
            border: 1px solid #eee;
            border-radius: 1rem;
            overflow: hidden;
            transition: var(--transition);
        }

        .story-card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-4px);
        }

        .story-content {
            padding: 1.5rem;
        }

        .story-category {
            display: inline-block;
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary);
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        .story-date {
            font-size: 0.75rem;
            color: var(--gray);
        }

        .story-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0.5rem 0;
        }

        .story-excerpt {
            font-size: 0.875rem;
            color: var(--gray);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .story-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            margin-top: 1rem;
            border-top: 1px solid #eee;
            font-size: 0.875rem;
            color: var(--gray);
        }

        .story-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .story-action {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .motivational-quote {
            background: var(--gradient);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            color: white;
            margin: 2rem 0;
        }

        .quote-text {
            font-size: 1.5rem;
            font-style: italic;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .quote-author {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.875rem;
        }

        /* Stories Tab */
        .stories-header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (min-width: 768px) {
            .stories-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .search-filter {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        @media (min-width: 768px) {
            .search-filter {
                flex-direction: row;
            }
        }

        .search-box {
            position: relative;
            flex: 1;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 0.75rem 0.75rem 2.5rem;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .filter-select {
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            font-size: 1rem;
            background: white;
            min-width: 150px;
        }

        /* Share Story Tab */
        .share-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .share-form {
            background: white;
            border-radius: 1rem;
            box-shadow: var(--shadow-lg);
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .form-textarea {
            min-height: 200px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 1.5rem 0;
        }

        .checkbox-group input {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary);
        }

        /* AI Chat Tab */
        .chat-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .chat-box {
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: var(--gradient);
            color: white;
            padding: 1rem 1.5rem;
        }

        .chat-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chat-header p {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            background-color: #f9fafb;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .message-user {
            background: var(--gradient);
            color: white;
            align-self: flex-end;
            border-top-right-radius: 0.25rem;
        }

        .message-ai {
            background: white;
            color: var(--dark);
            align-self: flex-start;
            border-top-left-radius: 0.25rem;
            box-shadow: var(--shadow);
        }

        .chat-input {
            display: flex;
            gap: 0.75rem;
            padding: 1rem;
            background: white;
            border-top: 1px solid #eee;
        }

        .chat-input input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid #ddd;
            border-radius: 0.75rem;
            font-size: 1rem;
        }

        .chat-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .chat-input button {
            padding: 0.75rem 1.5rem;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .chat-input button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .quick-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .quick-button {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid #eee;
        }

        .quick-button:hover {
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        .quick-button span {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .quick-button p {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--dark);
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 3rem 2rem;
            margin-top: 4rem;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-logo {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .footer-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .footer-logo-icon span {
            color: white;
            font-weight: bold;
            font-size: 1.25rem;
        }

        .footer-logo-text {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .footer-text {
            color: #9ca3af;
            max-width: 600px;
            margin: 0 auto 2rem;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .footer-divider {
            border-top: 1px solid #374151;
            margin: 2rem 0;
        }

        .footer-bottom {
            color: #6b7280;
            font-size: 0.875rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                padding: 1rem;
            }

            .logo-text {
                font-size: 1.5rem;
            }

            .nav-desktop {
                display: none;
            }

            .nav-mobile {
                display: block;
            }

            main {
                padding: 1rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1.125rem;
            }

            .featured-stories, .motivational-quote {
                padding: 1.5rem;
            }

            .story-card {
                margin-bottom: 1rem;
            }

            .chat-box {
                height: 400px;
            }
        }

        /* Content Tabs */
        .content-tab {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .content-tab.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }

        .no-results-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <span>जी</span>
                </div>
                <div>
                    <h1 class="logo-text">जीवनी</h1>
                    <p class="logo-subtext">आपकी कहानी, आपकी ताकत</p>
                </div>
            </div>
            <nav class="nav-desktop">
                <div class="nav-item active" data-tab="home">
                    <span></span>
                    <span>होम</span>
                </div>
                <div class="nav-item" data-tab="stories">
                    <span></span>
                    <span>कहानियाँ</span>
                </div>
                <div class="nav-item" data-tab="share">
                    <span>✍️</span>
                    <span>साझा करें</span>
                </div>
                <div class="nav-item" data-tab="chat">
                    <span></span>
                    <span>AI सहायता</span>
                </div>
            </nav>
        </div>
        <nav class="nav-mobile">
            <div class="nav-mobile-items">
                <div class="nav-mobile-item active" data-tab="home">
                    <div></div>
                    <div>होम</div>
                </div>
                <div class="nav-mobile-item" data-tab="stories">
                    <div></div>
                    <div>कहानियाँ</div>
                </div>
                <div class="nav-mobile-item" data-tab="share">
                    <div>✍️</div>
                    <div>साझा</div>
                </div>
                <div class="nav-mobile-item" data-tab="chat">
                    <div></div>
                    <div>चैट</div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Tab -->
        <div id="home" class="content-tab active">
            <!-- Hero Section -->
            <section class="hero">
                <h1 class="hero-title">आपकी कहानी महत्वपूर्ण है</h1>
                <p class="hero-subtitle">
                    जीवनी एक सुरक्षित स्थान है जहाँ आप अपने दर्द, आशाओं और जीत के बारे में बात कर सकते हैं। 
                    दूसरों की कहानियों से प्रेरणा लें और अपनी यात्रा में आगे बढ़ें।
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" data-tab="stories">
                        कहानियाँ पढ़ें
                    </button>
                    <button class="btn btn-secondary" data-tab="share">
                        अपनी कहानी साझा करें
                    </button>
                </div>
            </section>

            <!-- Featured Stories -->
            <section class="featured-stories">
                <h2 class="section-title">हाल की कहानियाँ</h2>
                <div class="stories-grid" id="featuredStoriesGrid">
                    <!-- Stories will be loaded here dynamically -->
                </div>
            </section>

            <!-- Motivational Quote -->
            <section class="motivational-quote">
                <blockquote class="quote-text">
                    "हर अंधेरे के बाद सुबह आती है।"
                </blockquote>
                <p class="quote-author">— जीवन की राह में</p>
            </section>
        </div>

        <!-- Stories Tab -->
        <div id="stories" class="content-tab">
            <div class="stories-header">
                <h2 class="section-title">सभी कहानियाँ</h2>
                <div class="search-filter">
                    <div class="search-box">
                        <span class="search-icon"></span>
                        <input type="text" id="searchStories" placeholder="कहानियाँ खोजें...">
                    </div>
                    <select id="categoryFilter" class="filter-select">
                        <option value="all">सभी श्रेणियाँ</option>
                        <option value="लव लॉस">लव लॉस</option>
                        <option value="परिवार">परिवार</option>
                        <option value="करियर">करियर</option>
                        <option value="आत्म-विकास">आत्म-विकास</option>
                        <option value="मानसिक स्वास्थ्य">मानसिक स्वास्थ्य</option>
                    </select>
                </div>
            </div>

            <div class="stories-grid" id="storiesGrid">
                <!-- Stories will be loaded here dynamically -->
            </div>
        </div>

        <!-- Share Story Tab -->
        <div id="share" class="content-tab">
            <div class="share-container">
                <div class="share-form">
                    <h2 class="section-title">अपनी कहानी साझा करें</h2>
                    <p style="text-align: center; color: #6b7280; margin-bottom: 2rem;">
                        अपने अनुभव साझा करके दूसरों को प्रेरित करें। आपकी कहानी किसी के लिए उम्मीद की किरण बन सकती है।
                    </p>

                    <form id="storyForm">
                        <div class="form-group">
                            <label for="storyTitle" class="form-label">कहानी का शीर्षक</label>
                            <input type="text" id="storyTitle" class="form-input" placeholder="कहानी का शीर्षक लिखें..." required>
                        </div>

                        <div class="form-group">
                            <label for="storyCategory" class="form-label">श्रेणी</label>
                            <select id="storyCategory" class="form-select">
                                <option value="लव लॉस">लव लॉस</option>
                                <option value="परिवार">परिवार</option>
                                <option value="करियर">करियर</option>
                                <option value="आत्म-विकास">आत्म-विकास</option>
                                <option value="मानसिक स्वास्थ्य">मानसिक स्वास्थ्य</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="storyContent" class="form-label">आपकी कहानी</label>
                            <textarea id="storyContent" class="form-textarea" placeholder="अपनी कहानी यहाँ लिखें... आपके शब्द किसी के लिए उम्मीद की किरण बन सकते हैं।" required></textarea>
                        </div>

                        <div class="checkbox-group">
                            <input type="checkbox" id="anonymousPost">
                            <label for="anonymousPost">गुमनाम रूप से पोस्ट करें</label>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            कहानी प्रकाशित करें
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- AI Chat Tab -->
        <div id="chat" class="content-tab">
            <div class="chat-container">
                <div class="chat-box">
                    <div class="chat-header">
                        <h2>
                            <span></span>
                            AI सहायता
                        </h2>
                        <p>24/7 उपलब्ध, सहानुभूतिपूर्ण सहायता</p>
                    </div>

                    <div class="chat-messages" id="chatMessages">
                        <div class="message message-ai">
                            नमस्ते! मैं आपकी मदद के लिए यहाँ हूँ। आप कैसे महसूस कर रहे हैं आज?
                        </div>
                    </div>

                    <form id="chatForm" class="chat-input">
                        <input type="text" id="chatInput" placeholder="अपनी भावनाएँ साझा करें...">
                        <button type="submit">भेजें</button>
                    </form>
                </div>

                <!-- Quick Help Buttons -->
                <div class="quick-buttons">
                    <div class="quick-button" data-message="मैं बहुत दुखी हूँ">
                        <span></span>
                        <p>मैं बहुत दुखी हूँ</p>
                    </div>
                    <div class="quick-button" data-message="मुझे प्रेरणा चाहिए">
                        <span>✨</span>
                        <p>मुझे प्रेरणा चाहिए</p>
                    </div>
                    <div class="quick-button" data-message="मैं हार मान रहा हूँ">
                        <span></span>
                        <p>मैं हार मान रहा हूँ</p>
                    </div>
                    <div class="quick-button" data-message="मैं अकेला महसूस कर रहा हूँ">
                        <span></span>
                        <p>मैं अकेला महसूस कर रहा हूँ</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <div class="footer-logo-icon">
                    <span>जी</span>
                </div>
                <h3 class="footer-logo-text">जीवनी</h3>
            </div>
            <p class="footer-text">
                एक सुरक्षित स्थान जहाँ आप अपनी कहानियाँ साझा कर सकते हैं, दूसरों की कहानियों से प्रेरणा ले सकते हैं, 
                और भावनात्मक सहायता प्राप्त कर सकते हैं। आप अकेले नहीं हैं।
            </p>
            <div class="footer-divider"></div>
            <p class="footer-bottom">
                © 2024 जीवनी. सभी अधिकार सुरक्षित। एक सहानुभूतिपूर्ण समुदाय के लिए।
            </p>
        </div>
    </footer>

    <!-- Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://ntmhbmegmkkpdu gxexhi.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
        const supabase = supabase.createClient(supabaseUrl, supabaseAnonKey);

        // Tab Navigation
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item, .nav-mobile-item');
            const tabs = document.querySelectorAll('.content-tab');

            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');

                    // Update active state for desktop nav
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                    });

                    // Update active state for mobile nav
                    document.querySelectorAll('.nav-mobile-item').forEach(nav => {
                        nav.classList.remove('active');
                    });

                    // Add active class to clicked item
                    this.classList.add('active');

                    // Show selected tab
                    tabs.forEach(tab => {
                        tab.classList.remove('active');
                    });

                    document.getElementById(tabId).classList.add('active');

                    // Load stories if stories tab is activated
                    if (tabId === 'stories') {
                        loadStories();
                    }
                });
            });

            // Hero buttons also trigger tab changes
            document.querySelectorAll('.btn[data-tab]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    document.querySelector(`.nav-item[data-tab="${tabId}"]`).click();
                });
            });

            // Story Form Submission
            const storyForm = document.getElementById('storyForm');
            storyForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                const title = document.getElementById('storyTitle').value;
                const category = document.getElementById('storyCategory').value;
                const content = document.getElementById('storyContent').value;
                const anonymous = document.getElementById('anonymousPost').checked;

                if (title && content) {
                    try {
                        const author = anonymous ? 'अनाम' : 'आप';

                        const { error } = await supabase
                            .from('jeevni')
                            .insert([
                                {
                                    title: title,
                                    category: category,
                                    content: content,
                                    author: author
                                }
                            ]);

                        if (error) {
                            alert('कहानी सबमिट करने में त्रुटि: ' + error.message);
                        } else {
                            alert('कहानी सफलतापूर्वक प्रकाशित की गई! धन्यवाद आपकी कहानी साझा करने के लिए।');
                            storyForm.reset();
                            document.querySelector('.nav-item[data-tab="stories"]').click();
                        }
                    } catch (err) {
                        alert('कहानी सबमिट करने में त्रुटि: ' + err.message);
                    }
                }
            });

            // AI Chat Functionality
            const chatForm = document.getElementById('chatForm');
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');

            const aiResponses = {
                'दुखी': 'मैं जानता हूँ आप दुखी महसूस कर रहे हैं। कृपया याद रखें कि आप अकेले नहीं हैं। समय सभी घाव भर देता है।',
                'हार': 'हार मानना आसान है, लेकिन उठकर फिर से कोशिश करना वीरता है। आप मजबूत हैं!',
                'प्रेरणा': 'यहाँ एक प्रेरणादायक उद्धरण है: "सूरज हर रोज नए सिरे से उगता है, आप भी नई शुरुआत कर सकते हैं।"',
                'रोना': 'रोना कमजोरी नहीं है। आँसू भी एक तरह की प्रार्थना होते हैं। आपकी भावनाएँ वैध हैं।',
                'अकेलापन': 'अकेलापन कठिन हो सकता है, लेकिन यह आपको अपने आप से जुड़ने का मौका देता है।'
            };

            function addMessage(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'message-user' : 'message-ai');
                messageDiv.textContent = text;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            chatForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const message = chatInput.value.trim();
                if (!message) return;

                addMessage(message, true);
                chatInput.value = '';

                // Simple AI response logic
                let aiReply = 'धन्यवाद आपके शब्दों के लिए। आपकी भावनाएँ महत्वपूर्ण हैं।';
                if (message.includes('दुखी')) aiReply = aiResponses['दुखी'];
                else if (message.includes('हार')) aiReply = aiResponses['हार'];
                else if (message.includes('प्रेरणा')) aiReply = aiResponses['प्रेरणा'];
                else if (message.includes('रो')) aiReply = aiResponses['रोना'];
                else if (message.includes('अकेला')) aiReply = aiResponses['अकेलापन'];

                setTimeout(() => addMessage(aiReply), 500);
            });

            // Quick buttons
            document.querySelectorAll('.quick-button').forEach(btn => {
                btn.addEventListener('click', function() {
                    const msg = this.getAttribute('data-message');
                    chatInput.value = msg;
                    chatForm.dispatchEvent(new Event('submit'));
                });
            });

            // Load stories on page load
            loadStories();
        });

        // Function to load stories from Supabase
        async function loadStories() {
            try {
                const { data, error } = await supabase
                    .from('jeevni')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    console.error('Error loading stories:', error);
                    return;
                }

                // Clear existing stories
                const storiesGrid = document.getElementById('storiesGrid');
                const featuredStoriesGrid = document.getElementById('featuredStoriesGrid');
                storiesGrid.innerHTML = '';
                featuredStoriesGrid.innerHTML = '';

                // Render stories
                data.forEach(story => {
                    const storyCard = createStoryCard(story);
                    storiesGrid.appendChild(storyCard);
                    if (data.indexOf(story) < 2) { // Show first 2 in featured section
                        featuredStoriesGrid.appendChild(storyCard.cloneNode(true));
                    }
                });

                // Apply search and filter
                applySearchAndFilter();
            } catch (err) {
                console.error('Error loading stories:', err);
            }
        }

        // Function to create a story card
        function createStoryCard(story) {
            const card = document.createElement('div');
            card.className = 'story-card';

            const content = document.createElement('div');
            content.className = 'story-content';

            const category = document.createElement('span');
            category.className = 'story-category';
            category.textContent = story.category;

            const date = document.createElement('span');
            date.className = 'story-date';
            date.textContent = new Date(story.created_at).toLocaleDateString();

            const title = document.createElement('h3');
            title.className = 'story-title';
            title.textContent = story.title;

            const excerpt = document.createElement('p');
            excerpt.className = 'story-excerpt';
            excerpt.textContent = story.content.length > 100 ? story.content.substring(0, 100) + '...' : story.content;

            const meta = document.createElement('div');
            meta.className = 'story-meta';

            const author = document.createElement('span');
            author.textContent = `लेखक: ${story.author}`;

            const actions = document.createElement('div');
            actions.className = 'story-actions';

            const likeAction = document.createElement('div');
            likeAction.className = 'story-action';
            likeAction.innerHTML = '<span>❤️</span><span>0</span>';

            const commentAction = document.createElement('div');
            commentAction.className = 'story-action';
            commentAction.innerHTML = '<span></span><span>0</span>';

            actions.appendChild(likeAction);
            actions.appendChild(commentAction);

            meta.appendChild(author);
            meta.appendChild(actions);

            content.appendChild(category);
            content.appendChild(date);
            content.appendChild(title);
            content.appendChild(excerpt);
            content.appendChild(meta);

            card.appendChild(content);

            return card;
        }

        // Function to apply search and filter
        function applySearchAndFilter() {
            const searchInput = document.getElementById('searchStories');
            const categoryFilter = document.getElementById('categoryFilter');
            const stories = document.querySelectorAll('.story-card');

            const searchTerm = searchInput.value.toLowerCase();
            const categoryValue = categoryFilter.value;

            stories.forEach(card => {
                const title = card.querySelector('.story-title').textContent.toLowerCase();
                const category = card.querySelector('.story-category').textContent;

                const matchesSearch = title.includes(searchTerm);
                const matchesCategory = categoryValue === 'all' || category === categoryValue;

                card.style.display = matchesSearch && matchesCategory ? 'block' : 'none';
            });
        }

        // Add event listeners for search and filter
        document.getElementById('searchStories').addEventListener('input', applySearchAndFilter);
        document.getElementById('categoryFilter').addEventListener('change', applySearchAndFilter);
    </script>
</body>
</html>
